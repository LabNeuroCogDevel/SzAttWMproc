a<-read.table(filename,sep=',',header=T)
a<-a[!is.nan(a$Crt),]
total_cor=length(which(a$Crt==1))
total_inc=length(which(a$Crt==0))
total_nors=length(which(a$Crt==-1))
c=length(which(a$Crt==-1))
per_cor=total_cor/(total_cor+total_inc)*100
per_cor_clin=total_cor/(total_cor+total_inc+total_nors)*100
per_inc=total_inc/(total_cor+total_inc)*100
per_nors=total_nors/(length(a$Crt))*100
#average RT for correct trial
avg_RT<-mean(a$RT[ is.finite(a$RT)])
avg_RT_pop<-mean(a$RT[ is.finite(a$RT) & a$trltp==1])
avg_RT_hab<-mean(a$RT[ is.finite(a$RT) & a$trltp==2])
avg_RT_flex<-mean(a$RT[ is.finite(a$RT) & a$trltp==3])
#pop
pop_cor<-sum(a$Crt == 1 & a$trltp  == 1, na.rm=TRUE)
pop_inc<-sum(a$Crt == 0 & a$trltp  == 1, na.rm=TRUE)
pop_nors<-sum(a$Crt == -1 & a$trltp  == 1, na.rm=TRUE)
pop_per_cor<-pop_cor/(pop_cor+pop_inc)*100
pop_per_inc<-pop_inc/(pop_cor+pop_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
hab_cor<-sum(a$Crt == 1 & a$trltp  == 2, na.rm=TRUE)
hab_inc<-sum(a$Crt == 0 & a$trltp  == 2, na.rm=TRUE)
hab_nors<-sum(a$Crt == -1 & a$trltp  == 2, na.rm=TRUE)
hab_per_cor<-hab_cor/(hab_cor+hab_inc)*100
hab_per_inc<-hab_inc/(hab_cor+hab_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
flex_cor<-sum(a$Crt == 1 & a$trltp  == 3, na.rm=TRUE)
flex_inc<-sum(a$Crt == 0 & a$trltp  == 3, na.rm=TRUE)
flex_nors<-sum(a$Crt == -1 & a$trltp  == 3, na.rm=TRUE)
flex_per_cor<-flex_cor/(flex_cor+flex_inc)*100
flex_per_inc<-flex_inc/(flex_cor+flex_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#calcualting % correct based on way that Dean & Brian do it
per_cor_clin<-total_cor/(total_cor+total_inc+total_nors)*100
pop_per_cor_clin<-pop_cor/(pop_cor+pop_inc+pop_nors)*100
hab_per_cor_clin<-hab_cor/(hab_cor+hab_inc+hab_nors)*100
flex_per_cor_clin<-flex_cor/(flex_cor+flex_inc+flex_nors)*100
#return(data.frame(subjid, per_cor, per_cor_clin, total_nors, pop_per_cor, pop_per_cor_clin, pop_nors, hab_per_cor, hab_per_cor_clin, hab_nors, flex_per_cor, flex_per_cor_clin, flex_nors))
return(data.frame(subjid, per_cor, pop_per_cor,hab_per_cor, flex_per_cor,avg_RT,avg_RT_pop,avg_RT_hab, avg_RT_flex, per_cor_clin, pop_per_cor_clin, hab_per_cor_clin,flex_per_cor_clin))
#return(data.frame(subjid,ld1_same_per_cor,ld1_dif_per_cor,ld3_same_per_cor,ld3_dif_per_cor))
}
data_table<-ldply(Attfiles,table_correct)
data_table<-ldply(Attfiles,table_correct)
prefix= '/Volumes/Phillips/P5/scripts/csv/Attention_'
data_table<-ldply(Attfiles,table_correct)
View(data_table)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj,]
View(data_table1)
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj,]
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet_wdx.txt",header=T)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[bad_subj,]
data_table1<-data_table[-bad_subj,]
data_table1<-data_table[-bad_subj]
data_table1<-data_table[-bad_subj,]
data_table1<-data_table[-bad_subj, ]
data_table<-data_table[-bad_subj, ]
data_table1<-data_table[-bad_subj, ]
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
data_table1<-data_table[-c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"), ]
data_table1<data_table[-c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"), ]
data_table1<data_table[-c(11330_20141002,11364_20150317,11454_20151019,11553_20160620), ]
data_table1<-data_table[--bad_subj, ]
data_table1<-data_table[bad_subj, ]
data_table1<-data_table[!bad_subj, ]
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620","10843_20151015"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
View(data_table1)
View(subj)
Attfiles <- Sys.glob('C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention*')
rm(list=ls())
#this is for attention behave data
library(plyr)
library(ggplot2)
library(LNCDR)
library(reshape)
library(dplyr)
library(tidyr)
today<-Sys.Date()
todayf<-format(today,format="%Y%m%d")
#load all the Attention behav files (they've already been run through matlab)
#copy them over from skynet
Attfiles <- Sys.glob('C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention*')
#Attfiles <- Sys.glob('/Volumes/Phillips/P5/scripts/csv/Attention*')
source("C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/WM/graphing_functions.R")
table_correct<-function(filename){
subjid <- gsub('_behave.csv','',gsub(prefix,'',filename))
a<-read.table(filename,sep=',',header=T)
a<-a[!is.nan(a$Crt),]
total_cor=length(which(a$Crt==1))
total_inc=length(which(a$Crt==0))
total_nors=length(which(a$Crt==-1))
c=length(which(a$Crt==-1))
per_cor=total_cor/(total_cor+total_inc)*100
per_cor_clin=total_cor/(total_cor+total_inc+total_nors)*100
per_inc=total_inc/(total_cor+total_inc)*100
per_nors=total_nors/(length(a$Crt))*100
#average RT for correct trial
avg_RT<-mean(a$RT[ is.finite(a$RT)])
avg_RT_pop<-mean(a$RT[ is.finite(a$RT) & a$trltp==1])
avg_RT_hab<-mean(a$RT[ is.finite(a$RT) & a$trltp==2])
avg_RT_flex<-mean(a$RT[ is.finite(a$RT) & a$trltp==3])
#pop
pop_cor<-sum(a$Crt == 1 & a$trltp  == 1, na.rm=TRUE)
pop_inc<-sum(a$Crt == 0 & a$trltp  == 1, na.rm=TRUE)
pop_nors<-sum(a$Crt == -1 & a$trltp  == 1, na.rm=TRUE)
pop_per_cor<-pop_cor/(pop_cor+pop_inc)*100
pop_per_inc<-pop_inc/(pop_cor+pop_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
hab_cor<-sum(a$Crt == 1 & a$trltp  == 2, na.rm=TRUE)
hab_inc<-sum(a$Crt == 0 & a$trltp  == 2, na.rm=TRUE)
hab_nors<-sum(a$Crt == -1 & a$trltp  == 2, na.rm=TRUE)
hab_per_cor<-hab_cor/(hab_cor+hab_inc)*100
hab_per_inc<-hab_inc/(hab_cor+hab_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
flex_cor<-sum(a$Crt == 1 & a$trltp  == 3, na.rm=TRUE)
flex_inc<-sum(a$Crt == 0 & a$trltp  == 3, na.rm=TRUE)
flex_nors<-sum(a$Crt == -1 & a$trltp  == 3, na.rm=TRUE)
flex_per_cor<-flex_cor/(flex_cor+flex_inc)*100
flex_per_inc<-flex_inc/(flex_cor+flex_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#calcualting % correct based on way that Dean & Brian do it
per_cor_clin<-total_cor/(total_cor+total_inc+total_nors)*100
pop_per_cor_clin<-pop_cor/(pop_cor+pop_inc+pop_nors)*100
hab_per_cor_clin<-hab_cor/(hab_cor+hab_inc+hab_nors)*100
flex_per_cor_clin<-flex_cor/(flex_cor+flex_inc+flex_nors)*100
#return(data.frame(subjid, per_cor, per_cor_clin, total_nors, pop_per_cor, pop_per_cor_clin, pop_nors, hab_per_cor, hab_per_cor_clin, hab_nors, flex_per_cor, flex_per_cor_clin, flex_nors))
return(data.frame(subjid, per_cor, pop_per_cor,hab_per_cor, flex_per_cor,avg_RT,avg_RT_pop,avg_RT_hab, avg_RT_flex, per_cor_clin, pop_per_cor_clin, hab_per_cor_clin,flex_per_cor_clin))
#return(data.frame(subjid,ld1_same_per_cor,ld1_dif_per_cor,ld3_same_per_cor,ld3_dif_per_cor))
}
data_table<-ldply(Attfiles,table_correct)
prefix= '/Volumes/Phillips/P5/scripts/csv/Attention_'
data_table<-ldply(Attfiles,table_correct)
View(data_table)
View(data_table)
prefix= 'C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention_'
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
View(data_table2)
View(data_table1)
table(data_table2$Cohort)
table(data_table2$confirmed_initial_dx1)
pval<- matrix(NA,ncol=1,nrow=9)
for (i in 2:9)
{
model_beh<-glm(data_table2[[i]]~as.factor(data_table2$Cohort),data=data_table2)
print((summary(model_beh)$coefficients[2,4]))
}
View(pval)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet_wdx.txt",header=T)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
View(subj)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
table(data_table2$Cohort)
table(data_table2$confirmed_initial_dx1)
rm(list=ls())
#this is for attention behave data
library(plyr)
library(ggplot2)
library(LNCDR)
library(reshape)
library(dplyr)
library(tidyr)
today<-Sys.Date()
todayf<-format(today,format="%Y%m%d")
#load all the Attention behav files (they've already been run through matlab)
#copy them over from skynet
Attfiles <- Sys.glob('C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention*')
#Attfiles <- Sys.glob('/Volumes/Phillips/P5/scripts/csv/Attention*')
source("C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/WM/graphing_functions.R")
#source("/Volumes/Phillips/P5/scripts/WM/graphing_functions.R")
prefix= 'C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention_'
table_correct<-function(filename){
subjid <- gsub('_behave.csv','',gsub(prefix,'',filename))
a<-read.table(filename,sep=',',header=T)
a<-a[!is.nan(a$Crt),]
total_cor=length(which(a$Crt==1))
total_inc=length(which(a$Crt==0))
total_nors=length(which(a$Crt==-1))
c=length(which(a$Crt==-1))
per_cor=total_cor/(total_cor+total_inc)*100
per_cor_clin=total_cor/(total_cor+total_inc+total_nors)*100
per_inc=total_inc/(total_cor+total_inc)*100
per_nors=total_nors/(length(a$Crt))*100
#average RT for correct trial
avg_RT<-mean(a$RT[ is.finite(a$RT)])
avg_RT_pop<-mean(a$RT[ is.finite(a$RT) & a$trltp==1])
avg_RT_hab<-mean(a$RT[ is.finite(a$RT) & a$trltp==2])
avg_RT_flex<-mean(a$RT[ is.finite(a$RT) & a$trltp==3])
#pop
pop_cor<-sum(a$Crt == 1 & a$trltp  == 1, na.rm=TRUE)
pop_inc<-sum(a$Crt == 0 & a$trltp  == 1, na.rm=TRUE)
pop_nors<-sum(a$Crt == -1 & a$trltp  == 1, na.rm=TRUE)
pop_per_cor<-pop_cor/(pop_cor+pop_inc)*100
pop_per_inc<-pop_inc/(pop_cor+pop_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
hab_cor<-sum(a$Crt == 1 & a$trltp  == 2, na.rm=TRUE)
hab_inc<-sum(a$Crt == 0 & a$trltp  == 2, na.rm=TRUE)
hab_nors<-sum(a$Crt == -1 & a$trltp  == 2, na.rm=TRUE)
hab_per_cor<-hab_cor/(hab_cor+hab_inc)*100
hab_per_inc<-hab_inc/(hab_cor+hab_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
flex_cor<-sum(a$Crt == 1 & a$trltp  == 3, na.rm=TRUE)
flex_inc<-sum(a$Crt == 0 & a$trltp  == 3, na.rm=TRUE)
flex_nors<-sum(a$Crt == -1 & a$trltp  == 3, na.rm=TRUE)
flex_per_cor<-flex_cor/(flex_cor+flex_inc)*100
flex_per_inc<-flex_inc/(flex_cor+flex_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#calcualting % correct based on way that Dean & Brian do it
per_cor_clin<-total_cor/(total_cor+total_inc+total_nors)*100
pop_per_cor_clin<-pop_cor/(pop_cor+pop_inc+pop_nors)*100
hab_per_cor_clin<-hab_cor/(hab_cor+hab_inc+hab_nors)*100
flex_per_cor_clin<-flex_cor/(flex_cor+flex_inc+flex_nors)*100
#return(data.frame(subjid, per_cor, per_cor_clin, total_nors, pop_per_cor, pop_per_cor_clin, pop_nors, hab_per_cor, hab_per_cor_clin, hab_nors, flex_per_cor, flex_per_cor_clin, flex_nors))
return(data.frame(subjid, per_cor, pop_per_cor,hab_per_cor, flex_per_cor,avg_RT,avg_RT_pop,avg_RT_hab, avg_RT_flex, per_cor_clin, pop_per_cor_clin, hab_per_cor_clin,flex_per_cor_clin))
#return(data.frame(subjid,ld1_same_per_cor,ld1_dif_per_cor,ld3_same_per_cor,ld3_dif_per_cor))
}
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
View(subj)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
table(data_table2$Cohort)
table(data_table2$confirmed_initial_dx1)
pval<- matrix(NA,ncol=1,nrow=9)
for (i in 2:9)
{
model_beh<-glm(data_table2[[i]]~as.factor(data_table2$Cohort),data=data_table2)
print((summary(model_beh)$coefficients[2,4]))
}
View(data_table2)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
rm(list=ls())
#this is for attention behave data
library(plyr)
library(ggplot2)
library(LNCDR)
library(reshape)
library(dplyr)
library(tidyr)
today<-Sys.Date()
todayf<-format(today,format="%Y%m%d")
#load all the Attention behav files (they've already been run through matlab)
#copy them over from skynet
Attfiles <- Sys.glob('C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention*')
#Attfiles <- Sys.glob('/Volumes/Phillips/P5/scripts/csv/Attention*')
source("C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/WM/graphing_functions.R")
#source("/Volumes/Phillips/P5/scripts/WM/graphing_functions.R")
#for just one individual
#filename = ('/Volumes/Phillips/P5/scripts/csv/Attention_10843')
prefix= 'C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/csv/Attention_'
#filename = ('//10.145.64.109/Phillips/P5/scripts/csv/Attention_10843')
#prefix= '//10.145.64.109/Phillips/P5/scripts/csv/Attention_'
#I'm making a function that I can then apply on all my files later on
table_correct<-function(filename){
subjid <- gsub('_behave.csv','',gsub(prefix,'',filename))
a<-read.table(filename,sep=',',header=T)
a<-a[!is.nan(a$Crt),]
total_cor=length(which(a$Crt==1))
total_inc=length(which(a$Crt==0))
total_nors=length(which(a$Crt==-1))
c=length(which(a$Crt==-1))
per_cor=total_cor/(total_cor+total_inc)*100
per_cor_clin=total_cor/(total_cor+total_inc+total_nors)*100
per_inc=total_inc/(total_cor+total_inc)*100
per_nors=total_nors/(length(a$Crt))*100
#average RT for correct trial
avg_RT<-mean(a$RT[ is.finite(a$RT)])
avg_RT_pop<-mean(a$RT[ is.finite(a$RT) & a$trltp==1])
avg_RT_hab<-mean(a$RT[ is.finite(a$RT) & a$trltp==2])
avg_RT_flex<-mean(a$RT[ is.finite(a$RT) & a$trltp==3])
#pop
pop_cor<-sum(a$Crt == 1 & a$trltp  == 1, na.rm=TRUE)
pop_inc<-sum(a$Crt == 0 & a$trltp  == 1, na.rm=TRUE)
pop_nors<-sum(a$Crt == -1 & a$trltp  == 1, na.rm=TRUE)
pop_per_cor<-pop_cor/(pop_cor+pop_inc)*100
pop_per_inc<-pop_inc/(pop_cor+pop_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
hab_cor<-sum(a$Crt == 1 & a$trltp  == 2, na.rm=TRUE)
hab_inc<-sum(a$Crt == 0 & a$trltp  == 2, na.rm=TRUE)
hab_nors<-sum(a$Crt == -1 & a$trltp  == 2, na.rm=TRUE)
hab_per_cor<-hab_cor/(hab_cor+hab_inc)*100
hab_per_inc<-hab_inc/(hab_cor+hab_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#pop
flex_cor<-sum(a$Crt == 1 & a$trltp  == 3, na.rm=TRUE)
flex_inc<-sum(a$Crt == 0 & a$trltp  == 3, na.rm=TRUE)
flex_nors<-sum(a$Crt == -1 & a$trltp  == 3, na.rm=TRUE)
flex_per_cor<-flex_cor/(flex_cor+flex_inc)*100
flex_per_inc<-flex_inc/(flex_cor+flex_inc)*100
#pop_per_nors<-pop_nors/(32)*100
#calcualting % correct based on way that Dean & Brian do it
per_cor_clin<-total_cor/(total_cor+total_inc+total_nors)*100
pop_per_cor_clin<-pop_cor/(pop_cor+pop_inc+pop_nors)*100
hab_per_cor_clin<-hab_cor/(hab_cor+hab_inc+hab_nors)*100
flex_per_cor_clin<-flex_cor/(flex_cor+flex_inc+flex_nors)*100
#return(data.frame(subjid, per_cor, per_cor_clin, total_nors, pop_per_cor, pop_per_cor_clin, pop_nors, hab_per_cor, hab_per_cor_clin, hab_nors, flex_per_cor, flex_per_cor_clin, flex_nors))
return(data.frame(subjid, per_cor, pop_per_cor,hab_per_cor, flex_per_cor,avg_RT,avg_RT_pop,avg_RT_hab, avg_RT_flex, per_cor_clin, pop_per_cor_clin, hab_per_cor_clin,flex_per_cor_clin))
#return(data.frame(subjid,ld1_same_per_cor,ld1_dif_per_cor,ld3_same_per_cor,ld3_dif_per_cor))
}
data_table<-ldply(Attfiles,table_correct)
bad_subj<-match(c("11330_20141002","11364_20150317","11454_20151019","11553_20160620"),data_table$subjid)
data_table1<-data_table[-bad_subj, ]
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet.txt",header=T)
View(subj)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet_wdx.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
table(data_table2$Cohort)
table(data_table2$confirmed_initial_dx1)
pval<- matrix(NA,ncol=1,nrow=9)
for (i in 2:9)
{
model_beh<-glm(data_table2[[i]]~as.factor(data_table2$Cohort),data=data_table2)
print((summary(model_beh)$coefficients[2,4]))
}
View(data_table2)
View(data_table1)
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet_wdx.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
table(data_table2$Cohort)
pval<- matrix(NA,ncol=1,nrow=9)
for (i in 2:9)
{
model_beh<-glm(data_table2[[i]]~as.factor(data_table2$Cohort),data=data_table2)
print((summary(model_beh)$coefficients[2,4]))
}
Att<-data_table2[,c(1,3:5,17)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
Att<-data_table2[,c(1,3:5,17)]
subj<-read.delim(file="C:/Users/Dhruv/Documents/GitHub/SzAttWMproc/scripts/SubjInfoGoogleSheet_wdx.txt",header=T)
data_table2<-merge(data_table1,subj,by.x="subjid",by.y="MRID")
table(data_table2$Cohort)
pval<- matrix(NA,ncol=1,nrow=9)
for (i in 2:9)
{
model_beh<-glm(data_table2[[i]]~as.factor(data_table2$Cohort),data=data_table2)
print((summary(model_beh)$coefficients[2,4]))
}
Att<-data_table2[,c(1,3:5,17)]
Att<-data_table2[ ,c(1,3:5,17)]
Att<-data_table2[ ,c(1,3:5,16)]
View(Att)
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
View(Att2)
Att_aov1<-aov(value~confirmed_initial_dx1*variable+Error(subjid/variable),data=Att2)
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
Att<-data_table2[,c(1,7:9,16)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
Att<-data_table2[ ,c(1,3:5,16)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
Att<-data_table2[,c(1,7:9,16)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~confirmed_initial_dx1*variable+Error(subjid/variable),data=Att2)
Att<-data_table2[,c(1,7:9,16)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
pval<- matrix(NA,ncol=1,nrow=9)
for (i in 6:9)
{
model_beh<-glm(data_table2[[i]]~as.factor(data_table2$Cohort),data=data_table2)
print((summary(model_beh)$coefficients[2,4]))
}
keep = match(c("subjid","per_cor","Cohort"), colnames(data_table2))
percor_plot<-data_table2[,keep]
colnames(percor_plot)[colnames(percor_plot)=="per_cor"]<-"value"
d.grp <- percor_plot %>%
group_by(Cohort) %>%
meanse
View(percor_plot)
xlab<-" "
ylab<-"% Correct"
textSize=26
p.grp <-
ggplot(d.grp) + aes(x=Cohort,y=avg,fill=Cohort) +
geom_bar(stat='identity',position='dodge') +
geom_errorbar(
aes(ymin=d.grp$avg-d.grp$se,ymax=d.grp$avg+d.grp$se),
position=position_dodge(0.9),
width=.25) +
theme_bw() +
# change the legend
theme(legend.position="top")+theme_bw(base_size=textSize)+theme(panel.border = element_rect(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+theme(legend.position="none")+scale_fill_manual(values=c('grey36','white'))+labs(x=(xlab), y=(ylab))+
# remove se bars for empty, draws border everywhere
aes(color=Cohort) + scale_color_manual(values=c('black','black'))+
coord_cartesian(ylim=c(80,100))
print(p.grp)
keep = match(c("subjid","avg_RT","Cohort"), colnames(data_table2))
percor_plot<-data_table2[,keep]
colnames(percor_plot)[colnames(percor_plot)=="avg_RT"]<-"value"
d.grp <- percor_plot %>%
group_by(Cohort) %>%
meanse
d.grp$avg<-d.grp$avg*1000
d.grp$se<-d.grp$se*1000
xlab<-" "
ylab<-"Reaction Time (ms)"
textSize=26
p.grp <-
ggplot(d.grp) + aes(x=Cohort,y=avg,fill=Cohort) +
geom_bar(stat='identity',position='dodge') +
geom_errorbar(
aes(ymin=d.grp$avg-d.grp$se,ymax=d.grp$avg+d.grp$se),
position=position_dodge(0.9),
width=.25) +
theme_bw() +
# change the legend
theme(legend.position="top")+theme_bw(base_size=textSize)+theme(panel.border = element_rect(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))+theme(legend.position="none")+scale_fill_manual(values=c('grey36','white'))+labs(x=(xlab), y=(ylab))+
# remove se bars for empty, draws border everywhere
aes(color=Cohort) + scale_color_manual(values=c('black','black'))+
coord_cartesian(ylim=c(400,700))
print(p.grp)
cols<-c(3:5)
for (i in colnames(data_table2)[cols])
{
textSize <- 20
dodge <- position_dodge(width=0.9)
means<-(tapply(data_table2[,i], data_table2$Cohort, mean,na.rm=TRUE))
means<-(as.vector(means))
pat<-data_table2[data_table2$Cohort=="Clinical",]
con<-data_table2[data_table2$Cohort=="Control",]
sem1<-std(pat[,i])
sem2<-std(con[,i])
sem<-cbind(sem1,sem2)
colnames(sem)<-c("Clinical","Control")
sem<-as.vector(sem)
group<-"Clinical, Control"
graph_data<-data.frame(group=factor(c("Patient","Control")), mean=c(means))
xlab <- "Group"
ylab= i
limits <- aes(ymax=means+sem, ymin=means-sem)
range2 <- range(means + 2*sem, means - 2*sem)
p <- ggplot(data=graph_data, aes(x=group, y=means,alpha=group,fill=group))
p2<-p+geom_bar(stat="identity",position=dodge)+
geom_errorbar(limits, position=dodge, width=0.25) +
coord_cartesian(ylim=c(92,100.5))+scale_alpha_discrete(range=c(1, 1)) +scale_fill_manual(values=c("grey36","white"))+
xlab(xlab) + ylab(ylab) + theme_bw(base_size=textSize)+theme(legend.position="none")+theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
print(p2)
}
print(p2)
std <- function(x) sd(x)/sqrt(length(x))
cols<-c(3:5)
for (i in colnames(data_table2)[cols])
{
textSize <- 20
dodge <- position_dodge(width=0.9)
means<-(tapply(data_table2[,i], data_table2$Cohort, mean,na.rm=TRUE))
means<-(as.vector(means))
pat<-data_table2[data_table2$Cohort=="Clinical",]
con<-data_table2[data_table2$Cohort=="Control",]
sem1<-std(pat[,i])
sem2<-std(con[,i])
sem<-cbind(sem1,sem2)
colnames(sem)<-c("Clinical","Control")
sem<-as.vector(sem)
group<-"Clinical, Control"
graph_data<-data.frame(group=factor(c("Patient","Control")), mean=c(means))
xlab <- "Group"
ylab= i
limits <- aes(ymax=means+sem, ymin=means-sem)
range2 <- range(means + 2*sem, means - 2*sem)
p <- ggplot(data=graph_data, aes(x=group, y=means,alpha=group,fill=group))
p2<-p+geom_bar(stat="identity",position=dodge)+
geom_errorbar(limits, position=dodge, width=0.25) +
coord_cartesian(ylim=c(92,100.5))+scale_alpha_discrete(range=c(1, 1)) +scale_fill_manual(values=c("grey36","white"))+
xlab(xlab) + ylab(ylab) + theme_bw(base_size=textSize)+theme(legend.position="none")+theme(panel.border = element_blank(), panel.grid.major = element_blank(),panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
print(p2)
}
Att<-data_table2[ ,c(1,3:5,16)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
Att<-data_table2[,c(1,7:9,16)]
Att2 <- melt(Att, id.vars=c("subjid","Cohort"))
Att_aov1<-aov(value~Cohort*variable+Error(subjid/variable),data=Att2)
summary(Att_aov1)
